# 取引先説明会要約ツール

## 概要

音声/動画ファイル（会議の録画・録音など）から文字起こしを行い、その内容と追加資料（PDF, Word, PowerPoint）を基にOpenAI APIを利用して要約を作成するデスクトップアプリケーションです。

過去に生成したSRTファイル（字幕ファイル）を直接読み込んで、要約作成や内容確認を行うことも可能です。

## 主な機能

*   **音声/動画からの文字起こし:** 
    *   `Faster Whisper XXL` のスタンドアロン版 (Faster-Whisper-XXL/faster-whisper-xxl.exe) を使用して高精度な文字起こしを行います。
    *   処理中の進捗状況を表示します。
    *   文字起こし結果はセグメント（発話区間）ごとに表示されます。
*   **SRTファイルのインポート:** 過去に作成したSRTファイルを読み込み、文字起こし結果として表示できます。
*   **セグメント再生:** 文字起こし結果の各セグメントに対応する音声（元のファイルが必要）を再生できます。
    *   再生にはQtMultimediaを使用し、互換性の問題が発生する場合はffmpegによる一時的なWAVファイル変換を行います。
*   **追加資料の読み込み:** PDF, Word (.docx), PowerPoint (.pptx) ファイルの内容をテキストとして抽出し、要約生成時のコンテキスト情報として利用します。
*   **AIによる要約生成:** 
    *   OpenAI API (GPTモデル) を利用して、文字起こし内容と追加資料に基づいた要約を生成します。
    *   複数の要約タイプ（標準、短い、詳細分析）やカスタムプロンプト、プロンプトファイルの利用が可能です。
    *   要約結果はMarkdown形式で生成され、HTMLに変換してリッチテキスト表示されます。
*   **結果の保存:** 文字起こし全文と生成された要約を、それぞれテキストファイルとして保存できます。

## 使い方

1.  **実行:** `main.py` を実行します。
    ```bash
    python main.py
    ```
2.  **OpenAI APIキー設定:** 初回起動時や必要に応じて、設定欄にOpenAI APIキーを入力し「保存」ボタンを押します。
3.  **ファイル選択:**
    *   **音声/動画:** 「音声選択...」ボタンで文字起こし対象のファイルを選択します。
    *   **SRT:** （任意）「SRT読込...」ボタンで既存のSRTファイルを選択します。これを読み込んだ場合、音声ファイル選択や文字起こし実行は不要です。
    *   **追加資料:** （任意）「追加資料...」ボタンで関連する資料ファイル（PDF, DOCX, PPTX）を選択します。
    *   **出力ディレクトリ:** （任意）「参照...」ボタンで結果（文字起こし・要約テキストファイル）の保存先を指定します。
4.  **文字起こし実行:** （SRTを読み込んでいない場合）音声/動画ファイルを選択後、「文字起こし実行」ボタンを押します。
5.  **要約タイプ選択:** 「要約」タブで、生成したい要約のタイプを選択します。カスタムプロンプトを使用する場合は、テキストエリアに入力するか、「参照...」でプロンプトファイル（.txt）を選択します。
6.  **要約作成実行:** 「要約作成実行」ボタンを押します。文字起こしと（必要なら）追加資料の内容を基に、選択したモデルとプロンプトで要約が生成されます。
7.  **結果確認:**
    *   「文字起こし」タブで、セグメントごとのテキストと（音声ファイルがある場合）再生ボタンが表示されます。
    *   「追加資料」タブで、読み込んだ資料のテキスト内容を確認できます。
    *   「要約」タブで、生成された要約がHTML形式で表示されます。
8.  **結果保存:** （任意）「結果を保存」ボタンを押すと、文字起こし全文と要約が指定した（またはデフォルトの）出力ディレクトリにテキストファイルとして保存されます。

## 依存関係

*   **Python 3.x**
*   **必要なライブラリ:** `requirements.txt` を参照してください。以下のコマンドでインストールできます。
    ```bash
    pip install -r requirements.txt
    ```
*   **Faster Whisper XXL:** プロジェクト内に `Faster-Whisper-XXL` ディレクトリがあり、その中に `faster-whisper-xxl.exe` が含まれている必要があります。
*   **ffmpeg:** プロジェクト内の `Faster-Whisper-XXL` ディレクトリに `ffmpeg.exe` と `ffprobe.exe` が含まれている必要があります。（音声再生時の互換性維持と文字起こし前の音声長取得のため）
*   **(初回のみ) Markdownライブラリ:** 要約のHTML表示のために `markdown` ライブラリが必要です。初回要約実行時にインストールを試みますが、失敗する場合は手動で `pip install markdown` を実行してください。
*   **(コーデック問題発生時) K-Lite Codec Pack:** QtMultimediaでの音声再生時にエラーが出る場合、コーデックの問題が考えられます。[K-Lite Codec Pack](https://codecguide.com/download_kl.htm) の Basic または Standard をインストールすると解決することがあります。

## 注意事項

*   OpenAI APIの利用には別途APIキーの取得と利用料金が必要です。
*   文字起こしや要約の精度は、元の音声の品質、モデル、プロンプトの内容によって変化します。
*   `ffmpeg` の変換処理には時間がかかる場合があります。
